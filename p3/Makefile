SHELL := /bin/bash

CLUSTER_NAME ?= iot-cluster
APP_NAME ?= wil-playground
APP_NAMESPACE ?= dev
APP_LOCAL_PORT ?= 8888
APP_REMOTE_PORT ?= 80
ARGOCD_PORT ?= 8080

.PHONY: setup start clean pass status fw sfw guide help

setup:
	@bash scripts/setup.sh $(CLUSTER_NAME) $(ARGOCD_PORT)

start:
	@bash scripts/start-argocd.sh $(CLUSTER_NAME)

pass:
	@bash scripts/get-password.sh $(CLUSTER_NAME)

clean:
	@bash scripts/clean.sh $(CLUSTER_NAME)

status:
	@bash scripts/status.sh $(CLUSTER_NAME)

fw:
	@bash scripts/start-forward.sh $(APP_NAME) $(APP_NAMESPACE) $(APP_LOCAL_PORT) $(APP_REMOTE_PORT)

sfw:
	@bash scripts/stop-forward.sh

guide:
	@bash scripts/argo-guide.sh

help:
	@echo "ðŸ§ª KullanÄ±labilir komutlar:"
	@echo ""
	@echo "  make setup                      â†’ Sistemi kurar (cluster: $(CLUSTER_NAME))"
	@echo "  make setup CLUSTER_NAME=abc    â†’ Belirli cluster adÄ±yla kurar"
	@echo ""
	@echo "  make start                      â†’ Argo CD port-forward baÅŸlatÄ±r"
	@echo "  make pass                       â†’ Argo CD ÅŸifresini gÃ¶sterir"
	@echo ""
	@echo "  make fw                         â†’ Uygulama port yÃ¶nlendirmesini baÅŸlatÄ±r"
	@echo "      VarsayÄ±lan: $(APP_NAME) @ $(APP_NAMESPACE) â†’ localhost:$(APP_LOCAL_PORT) â†’ svc:$(APP_REMOTE_PORT)"
	@echo "      Ã–rnek: make fw APP_NAME=api APP_NAMESPACE=prod APP_LOCAL_PORT=9999 APP_REMOTE_PORT=8080"
	@echo ""
	@echo "  make sfw                        â†’ Port yÃ¶nlendirmesini durdurur"
	@echo "  make status                     â†’ Cluster ve pod durumlarÄ±nÄ± gÃ¶sterir"
	@echo "  make clean                      â†’ Clusterâ€™Ä± ve tÃ¼m geÃ§ici iÅŸlemleri siler (cluster: $(CLUSTER_NAME))"
	@echo "  make clean CLUSTER_NAME=abc     â†’ Belirli clusterâ€™Ä± siler"
	@echo ""
	@echo "  make guide                      â†’ Argo CD Ã¼zerinden uygulama ekleme rehberi"
	@echo "  make help                       â†’ Bu yardÄ±m mesajÄ±nÄ± gÃ¶sterir"
